@model ChessModel.Game

@{
    if (Model.BlackPlayer == null)
    {
        ViewBag.Title = Model.WhitePlayer + "'s game";
    }
    else
    {
        ViewBag.Title = Model.WhitePlayer + " vs " + Model.BlackPlayer;
    }
}

<div id="game">
    @Html.Partial("game", Model)
</div>

<script type="text/javascript">
    //<![CDATA[
    $('.movable').draggable({
        containment: "table",
        revert: 'invalid'
    });

    $('.square').droppable({
        drop: function (ev, ui) {
            var dropped = ui.draggable;
            var droppedOn = $(this);
            
            if ($(dropped).attr("data-move-to").indexOf(droppedOn.attr("id")) >= 0) {

                var moveForm = document.forms[0];
                moveForm.elements["move"].value = $(dropped).parent().attr("id") + "-" + droppedOn.attr("id");
                moveForm.submit();
            }
            else {
                $(dropped).css({ top: 0, left: 0 })
            }
        }
    });

</script>
